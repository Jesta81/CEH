# IoT Attack Countermeasures

This section discusses various IoT security measures, device management, and security tools that can be used to prevent, protect, and recover from various types of attacks on IoT devices and their networks. Following these countermeasures, organizations can implement proper security mechanisms to protect the confidential information transmitted between the devices and the corporate network.

## How to Defend Against IoT Hacking 

1. Disable the “guest” and “demo” user accounts if enabled. 
2. Use the “Lock Out” feature to lock out accounts for excessive invalid login attempts. 
3. Implement a strong authentication mechanism. 
4. Locate control system networks and devices behind firewalls, and isolate them from the business network. 
5. Implement IPS and IDS in the network. 
6. Implement end-to-end encryption and use public key infrastructure (PKI). 
7. Use VPN architecture for secure communication. 
8. Deploy security as a unified, integrated system. 
9. Allow only trusted IP addresses to access the device from the Internet. 
10. Disable telnet (port 23). 
11. Disable the UPnP port on routers. 
12. Protect the devices against physical tampering. 
13. Patch vulnerabilities and update the device firmware regularly. 
14. Monitor traffic on port 48101, as infected devices attempt to spread the malicious file using port 48101. 
15. Position of mobile nodes should be verified with the aim of referring one physical node with one vehicle identity only, which means one vehicle cannot have two or more identities. 
16. Data privacy should be implemented; therefore, the user’s account or identity should be kept protected and hidden from other users. 
17. Data authentication should be performed to confirm the identity of the original source node. 
18. Maintain data confidentiality using symmetric key encryption. ▪ Implement a strong password policy requiring a password at least 8–10 characters long with a combination of letters, numbers, and special characters. 
19. Use CAPTCHA and account lockout policy methods to avoid brute-force attacks . ▪ Use devices made by manufacturers with a track record of security awareness. ▪ Isolate IoT devices on protected networks. ▪ Implement a secure boot option that uses cryptographic code signing techniques, and ensure the device executes code generated by the device’s original equipment manufacturer (OEM).
20. Implement two-way authentication by using a cryptographic algorithm that can use both symmetric keys using SHA with HMAC and asymmetric keys using ECDSA.
21. Create an asset inventory for mapping the network and for discovering all paths of ingress and egress to determine whether the IoT network has its own Internet gateway that does not follow the security policies or applicable laws, regulations, and contracts.
22. Apply access controls between the IoT devices and IT resources by using enterprise firewalls, IDS/IPS, UBA, IAM, etc.
23. Always read the privacy policy of an application before installing to check on the information it can access.
24. Use a trusted execution environment (TEE) or security element (SE), TrustZone for ARM, to secure sensitive information.
25. Implement active masking or shielding to protect devices from side-channel attacks. 
26. Validate code immediately before its use to reduce the risk of time-of-check to time-of-use (TOCTOU) attacks. 
27. Secure encryption keys and credentials by storing them in a Secure Access Module (SAM), Trusted Platform Module (TPM), Hardware Security Module (HSM), or another trusted key store.
28. Prevent disclosure of IP addresses by disabling WebRTC in the browser. ▪ Use ad-blockers and non-trackable extensions available on the browser to prevent web-based attacks on IoT devices. 
29. Filter private IP addresses from DNS replies using dnswall to prevent DNS rebinding attacks. 
30. Use the cloud-based anti-DDoS solution for filtering or diverting malicious DDoS traffic. 
31. Employ content distribution networks (CDNs) and smart DNS resolution services to provide an additional layer of network infrastructure. 
32. Change the default settings of the router, including the router name and password. 
33. Do not use public Wi-Fi for IoT device management. 
34. Disable unwanted features of IoT devices when not in use. 
35. Implement cloud-based solutions that provide enhanced security to IoT edge devices. 
36. Maintain a proper vulnerability revelation policy for improved security. Care and validation must be performed on those vulnerabilities periodically. 
37. Employ a limited privilege access policy for both IoT hardware and firmware (i.e., unused ports, privileged data access, administrative access, etc.). 

### How to Prevent SDR-Based Attacks

Attacks on IoT devices can be launched from any direction with persistent efforts and holding knowledge on some available tools. However, one must be proactive to prevent such attacks before the devices are compromised. 

The following methods can help in protecting IoT devices from SDR-based attacks: 

1. #### Securing the signal
> - One of the most significant preventive measures to avoid software-based radio attacks is securing the signals using standard encryption methods. 

2. #### Avoiding command repetition using a rolling technique 
> - Frequent usage of the same commands can allow replay attacks. Commands should be initiated based on the rolling window scheme; this means that a command used earlier should not be initiated again. Flaws in this implementation can allow brute-force attacks. 

3. #### Adopting synchronization and preamble nibbles 
> - Segregate the command sequence using preamble and synchronization nibbles, or else the protocols can be brute-forced using a reduction method such as a de Bruijn sequence. This can overlap the common bits negotiating the number of bits needed to replay the multiple command sequences. 



## General Guildlines for IoT Device Manufacturers

1. SSL/TLS should be used for communication purposes. 
2. There should be a mutual check on SSL certificates and the certificate revocation list. 
3. Use of strong passwords should be encouraged. 
4. Ensure credentials are not hardcoded; they must be stored separately in secure trusted storage. 
5. The device’s update process should be simple, secured with a chain of trust. 
6. Implement account lockout mechanisms after certain incorrect login attempts to prevent brute force attacks. 
7. Lock the devices down whenever and wherever possible to prevent them from attacks. 
8. Periodically check the device for unused tools and use whitelisting to allow only trusted tools or applications to run. 
9. Use a secure boot chain to verify all software that is executed on the device. 
10. Scrutinize new features of a product for any security flaw before it is released. 
11. Use safe functions such as (gets()->fgets()) to reduce the risk of buffer overflow vulnerabilities, as most IoT programs are written in C or C++. 
12. Incorporate security into the IoT software development lifecycle. 
13. Ensure the security of users’ personal data by providing detailed information regarding the information sharing and data transfer. 
14. Provide proper guidelines for consumers regarding device security and configuration settings. 
15. Implement an external hardware tamper alert to ensure the physical security of the IoT device for the end user.


## OWASP Top 10 IoT Vulnerabilites Solutions 

1. ### Weak, Guessable, or Hardcoded Passwords
> - Use Automated Password Management (APM). 
> - Use strong and complex passwords. 
> - Avoid using hard-coded passwords. 

2. ### Insecure Network Services
> - Close open network ports. 
> - Disable UPnP. 
> - Encrypt data prior to TLS communication. 

3. ### Insecure Ecosystem Interfaces
> - Enable account lockout mechanism. 
> - Conduct a periodic assessment of interfaces. 
> - Use a strong password and two-factor authentication. 

4. ### Lack of Secure Update Mechanism 
> - Verify the source and integrity of updates. 
> - Encrypt communication between endpoints. 
> - Notify end-users of security updates. 

5. ### Use of Insecure of Outdated Components 
> - Monitor regularly for unmaintained components. 
> - Remove unused dependencies and unnecessary features. 
> - Avoid third-party software from compromised supply chain. 

6. ### Insufficient Privacy Protection 
> - Minimize data collection. 
> - Anonymize collected data. 
> - Provide end-users with the ability to decide what data is collected. 

7. ### Insecure Data Transfer and Storage 
> - Encrypt communication between endpoints. 
> - Maintain SSL/TLS implementations. 
> - Avoid using propriety encryption solutions. 

8. ### Lack of Device Management 
> - Blacklist malicious devices from suspicious sources. 
> - Validate all asset attributes. 
> - Secure decommissioning of devices. 

9. ### Insecure Default Settings 
> - Change the default usernames and passwords. 
> - Custom modify the privacy and security settings. 
> - Disable remote access to IoT devices when not in use. 

10. ### Lack of Physical Hardening 
> - Set unique password for BIOS/firmware. 
> - Configure device boot order to prevent unauthorized booting. 
> - Minimize external ports such as USB ports. 


## Iot Framework Security Considerations

![IoT Framework](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/IoT-Framework.png) 

To design secure and protected IoT devices, security issues should be properly considered. One of the most important considerations is the development of a secure IoT framework for building the device. Ideally, a framework should be designed in a way that provides default security, so that the developers do not have to consider it later. 

Security evaluation criteria for the IoT framework are broken down into four parts. Each part has its own security-related concerns that are discussed in the evaluation criteria for each part. The security evaluation criteria for the IoT devices are discussed below: 

1. ### EDGE
> - Communications encryption
> - Storage encryption
> - Update components
> - No default passwords

2. ### GATEWAY 
> - Multi-directional encrypted communications
> - Strong authentication of all the components
> - Automatic updates

3. ### CLOUD PLATFORM 
> - Encrypted communications
> - Secure web interface
> - Authentication
> - Encrypted storage
> - Automatic updates

4. ### MOBILE 
> - Local storage security
> - Encrypted communications channels
> - Multi-factor authentication
> - Account lockout mechanism

## IoT Hardware Security Best Practices

![IoT Security](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/IoT-Security.png) 

Securing IoT hardware plays a major role in preventing most persistent attacks at the seed level. However, there are several differences in the manufacturing, development, and deploying of IoT hardware of different manufacturers. 

The following countermeasures can be adopted by organizations to secure their IoT hardware from most persistent attacks prevalent in this modern digital world: 

1. ### Limit the Entry Points 
> - Limit the scope of entry for attackers by avoiding the deployment of additional entry points such as USB ports to the IoT hardware. 
> - This helps in avoiding the intrusion of attackers through open or unused ports. 
> - Lock the least-used or open entry points to avoid direct intrusion into the device. 

2. ### Employ a Hardware Tamper Protection Mechanism 
> - Implement a hardware tampering detection mechanism to detect direct physical damage or intrusion into the board level of the IoT hardware. 
> - This helps in the detection of device lifting, alteration, lid removal, chip-level access, etc. on the hardware unit. 
> - The installation of a proper GPS unit also helps in tracking the misplaced unit. 

3. ### Monitor Secure Booting 
> - Monitor the booting source to prevent attackers from tampering with or glitching the hardware unit to implement boot-level attacks, which provides privileged access to the attackers. 
> - Depending on the asset value, implement secure data storage mechanisms such as Trusted Platform Module (TPM) chips. 

4. ### Implement security patches 
> - Update the firmware in a timely and secure manner, as IoT hardware becomes vulnerable to major threats during pre-and post-patch updating processes. 

5. ### Maintain a Proper Interface Management System 
> - Integrate the IoT hardware properly with secure interfaces during the development phase to avoid API and library snatching from the unit. 
> - The APIs create vulnerabilities to hardware security because they provide actual data regarding the device activities and functionality at the end-user location. 

6. ### Avoid Open Access to the Hardware Unit 
> - Implement proper physical protection for the hardware unit because most IoT hardware deployment is at open public places and harsh environments. 
> - To avoid major damage to the hardware unit, close all open ports or entry points with dummies to avoid unwanted intrusion or physical damage to the unit. 

7. ### Secure Authentication Keys 
> - Safely secure the keys used for the authentication of each device associated with a unique device ID crafted by the corresponding cloud service. 
> - Implement a proper safety mechanism to secure all these keys because a security breach to these key lists allows attackers to control the hardware units. 

8. ### Maintain a Proper Event Logging Mechanism 
> - Implement timely security audits to maintain a continuous event logging and monitoring mechanism for improved incident handling and response. 
> - Maintain proper logs for all the security intrusions to prevent the recurrence of attacks on the hardware units. 

9. ### Maintain a Proper Anti-Malware Protection System 
> - Install trusted third-party antivirus/anti-malware software to detect and avoid security breaches at the entry points of the hardware unit. 

10. ### Enable a Default Entry-Level Logging Mechanism 
> - Monitor the entry logs periodically by enabling the continuous logging facility provided by most operating systems (OSes). 
> - The log monitoring mechanism helps in avoiding major security breaches at the entry level. 

11. ### Protect Device Access Credentials 
> - Secure the device access credentials by maintaining several security mechanisms such as magic-number implementation, encryption, and two-factor authentication. 

12. ### Isolate Devices from Regular Supply Units 
> - Secure the device from electrification and spike attacks such as rowhammer attacks, which create a sudden surge in electric pulses and cause damage to the RAM chips and core. 

13. ### Implement a Root-on-Trust Mechansim 
> - Enable a safe entry-point system for root-level access by implementing a root-on-trust mechanism that allows access to trusted or authorized users only. 

14. ### Secure Legacy Units Enabling Modern Gateway Security Features 
> - Deploy modern gateways in IoT networks comprising legacy units to employ security mechanisms without any alteration or upgradation of the device. 

## Countermeasures for encrypting communications data and TPMs of IoT hardware units: 

1. Utilize third-party authentication software such as Bitlocker drive encryption to authenticate the data imported from an external storage location outside the TPM perimeter. 

2. Employ software tools such as Nuvoton for IoT hardware units by using communication interfaces such as I2C and SPI in TPM devices. 

3. Bind the data to be transferred using a TPM bind key, which is a special encryption key based on the RSA encryption standard. 

4. Implement the sealing and unsealing concept of hardware authentication during major computational updates for IoT hardware units such as firmware updates and security patches. 

5. Employ an HMAC-key-based secure data communication mechanism between the TPM-based IoT device and the end user. 

6. Implement symmetric-key-based encryption for low-data-transmission applications, in which the data are stored outside the TPM perimeter, for ensuring the authenticity and integrity of the imported data. 

7. Verify sender authentication prior to the decryption of received data using the HMAC verification procedure facilitated by TPM devices using block-mode encryption algorithms such as cipher block chaining (CBC) and ciphertext feedback (CFB). 

8. Utilize RSA-based encryption to ensure data integrity with a digital signature. 

9. TPMs facilitate the storage of keys in non-volatile random-access memory (NVRAM) to enable the R/W option during unwanted incidents such as data loss due to environmental stress or malicious attacks. 

10. Utilize the canonical mode of data transfer, which helps in optimized data transfer by eliminating the unwanted bytes from a prolonged data-stream communication application using TPM-based IoT devices. 

11. Utilize root-of-trust (RT) models such as RT for measurement (RTM) and RT for verification (RTV) provided by TPM devices for secure booting and data transmission in IoT hardware units. 


## IoT Device Management 

![IoT Management](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/IoT-Management.png) 

IoT device management helps in supporting IoT solutions by using any software tools and processes and helps in **onboarding latest devices** securely and promptly. 

It allows the users to track, monitor, and manage physical IoT devices and forces users to **remotely update the firmware**. 

IoT device management helps in providing permissions and security capabilities for protection against vulnerabilities. 

### IoT Device Management Solutions 

IoT device management solutions are used by security professionals, IT admin, or IoT administrators for onboarding, organizing, monitoring, and managing IoT devices. Discussed below are some IoT device management solutions:

1. #### Azure IoT Central 

[Azure IoT Central](https://azure.microsoft.com) is a hosted, extensible software-as-a-service (SaaS) platform that simplifies the setup of IoT solutions. 

It helps to easily connect, monitor, and manage IoT assets at scale. 

Azure IoT Central can simplify the initial setup of an IoT solution and can reduce the management burden, operational costs, and overheads of a typical IoT project. 

![Azure IoT Central](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/Azure-IoT-Central.png) 

Listed below are some of the additional solutions for IoT device management: 

> - [Oracle Fusion Cloud Internet of Things (IoT)](https://www.oracle.com) 
> - [Predix](https://www.ge.com)
> - [Cloud IoT Core](https://cloud.google.com) 
> - [IBM Watson IoT Platform](https://www.ibm.com) 
> - [BalenaCloud](https://www.balena.io) 


## IoT Security Tools 

1. ### SeaCat.io

> - [SeaCat.io](https://teskalabs.com) is a security-first SaaS technology to operate IoT products in a reliable, scalable, and secure manner. 
>
> - It provides protection to end-users, businesses, and data. 
>
> - Security professionals use SeaCat.io to manage connected products from a central place, access remote devices using various tools, monitor connected devices and automate updates to fix bugs, protect users with authorized cryptography and comply with regulations, ensure devices are malware-free and prevent hackers from controlling them and making them part of a botnet, etc. 

![SeaCat](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/SeaCat.png) 

2. ### DigiCert IoT Device Manager 

> - [DigiCert IoT Device Manager](https://www.digicert.com) uses modern public key infrastructure (PKI) to deliver digital trust that meets the needs of even the most demanding IoT deployments. 
>
> - The solution centrally manages discovery, reporting, certificate creation and revocation, and user access and permissions. 
>
> - It enables enterprise security to work easily with any number of systems using REST application programming interface (API), Simple Certificate Enrollment Protocol (SCEP), Enrollment over Secure Transport (EST), and Certificate Management Protocol version 2 (CMPv2). 

![DigiCert](/IoT-and-OT-Hacking/IoT-Attack-Countermeasures/images/DigiCert.png) 

